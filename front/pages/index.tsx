import { useEffect, useState } from "react";
import { useDispatch, useSelector } from "react-redux";
import Layout from "../components/Layout";
import styles from "../styles/main.module.scss";
import ByteUpload from "../components/ByteUpload";
import HeatMap from "components/HeatMap";
import Opcode from "components/Opcode";
import { SERVER_TEST_REQUEST } from "reducers/server";
import { RootState } from "reducers";

const Home = () => {
  const dispatch = useDispatch();
  const { strIdx } = useSelector((state: RootState) => state.File);
  const [byteFile, setByteFile] = useState<File>();
  const [upload, setUpload] = useState(false);
  const [heatmap, setheatmap] = useState(false);
  const [byteExploit, setbyteExploit] = useState(false);
  const [opExploit, setopExploit] = useState(false);
  const onClickServerTest = () => {
    dispatch({
      type: SERVER_TEST_REQUEST,
    });
  };
  useEffect(() => {}, []);
  return (
    <>
      <Layout>
        <div className={styles.main_page}>
          <div className={styles.main_title}>
            <div>이미지 기반 악성코드</div>
            <div>익스플로잇 코드 블록 탐지</div>
          </div>
          <div className={styles.main_button_wrapper}>
            <div className={styles.main_button}>
              <span>Byte 파일 업로드하기</span>
              <ByteUpload setByteFile={setByteFile} />
            </div>
            <div className={styles.main_button}>
              <span>업로드된 파일 heatmap 보기</span>
              <HeatMap />
            </div>
            {strIdx != null && (
              <div className={styles.main_button}>
                <span>변환된 Exploit Code Block 확인하기</span>
                <Opcode bytefile={byteFile} />
              </div>
            )}
          </div>
          <div className={styles.server_test_button} onClick={onClickServerTest}>
            <span>서버 접속 테스트</span>
          </div>
        </div>
      </Layout>
    </>
  );
};
export default Home;
