import axios from "axios";
import { SERVER_TEST_FAILURE, SERVER_TEST_REQUEST, SERVER_TEST_SUCCESS } from "reducers/server";
import { all, call, fork, put, select, takeLatest } from "redux-saga/effects";

axios.defaults.baseURL = process.env.NEXT_PUBLIC_API_BASE_URL;

function serverTestAPI(data) {
  return axios.get(`/serverTest`, { headers: { withCredentials: true } });
}
function* serverTest(action: any) {
  try {
    const response = yield call(serverTestAPI, action.data);
    yield put({
      type: SERVER_TEST_SUCCESS,
      data: response.data,
    });
    yield alert(response.data);
  } catch (err) {
    yield put({
      type: SERVER_TEST_FAILURE,
      error: err,
    });
  }
}
function* watchserverTest() {
  yield takeLatest(SERVER_TEST_REQUEST, serverTest);
}

export default function* File() {
  yield all([fork(watchserverTest)]);
}
