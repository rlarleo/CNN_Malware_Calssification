import os  # 운영체제에서 제공되는 여러 기능을 파이썬에서 수행할 수 있게 해줌.
from flask import Flask, flash, request, redirect
from flask import url_for, render_template
from werkzeug.utils import secure_filename

app = Flask(__name__)
app.secret_key = 'random string'  # 프레임워크 상에서 꼭 넣으라고 요구함.


@app.route('/upload')
def upload_file():
    return render_template('upload.html')


@app.route('/uploader', methods=['GET', 'POST'])
def uploader():
    if request.method == 'POST':
        # 제출 요청한 파일이 있는지 확인
        if request.files['file'].filename == '':
            flash('파일이 없습니다. 파일을 제출하세요!')
            # 파일이 없으면 flash 전달. (현재 창에서 flash 메시지 출력.)
            return redirect(url_for('upload_file'))
        # if request.files['file'].filename == '':
        #    return '파일이 존재하지 않습니다.'

        # 파일이 존재한다면
        file = request.files['file']  # request.files: 단일 파일
        file.save(secure_filename(file.filename))
        # file.filename: 업로드한 파일 이름
        # secure_filenmae: 파일이름을 보안 처리
        # file.save: 인자값으로 경로가 없으면 py파일과 같은 경로에 저장됨.
        return '파일 업로드 성공!!'


if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=True)